<!DOCTYPE html><html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-concepts/consistency" data-theme="light" data-rh="lang,dir,class"><head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title>Consistency Model | Replicache Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.replicache.dev/concepts/consistency"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Consistency Model | Replicache Docs"><meta data-rh="true" name="description" content="The Consistency Model of a distributed system like Replicache describes the guarantees the system makes about how operations are applied within the system."><meta data-rh="true" property="og:description" content="The Consistency Model of a distributed system like Replicache describes the guarantees the system makes about how operations are applied within the system."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://doc.replicache.dev/concepts/consistency"><link data-rh="true" rel="alternate" href="https://doc.replicache.dev/concepts/consistency" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.replicache.dev/concepts/consistency" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Y3T1SV2WRD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Replicache Docs" href="/opensearch.xml">
<script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-GQBKRVPR1B&amp;l=dataLayer&amp;cx=c&amp;gtm=45He4cc1v865895793za200"></script><script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-PTN768T"></script><script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-PTN768T",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>

<script src="/js/redirects.js"></script><link rel="stylesheet" href="/assets/css/styles.9185dd9b.css">
<link rel="preload" href="/assets/js/runtime~main.ca11e309.js" as="script">
<link rel="preload" href="/assets/js/main.6abc1f11.js" as="script">
<meta name="viewport" content="width=device-width, initial-scale=1.0" data-rh="true"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/31e8c40f.93fb1be8.js"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/cdefb962.6e7ce52f.js"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/8472f356.c7f2219a.js"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/21dd1cf3.396897e4.js"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/5f2ffadc.666f1eaf.js"><link rel="prefetch" href="/assets/js/1be78505.2ff0b744.js"><link rel="prefetch" href="/assets/js/a4df073c.e9e4229e.js"><link rel="prefetch" href="/assets/js/935f2afb.dec4d439.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/59a64286.400d29cd.js"><link rel="prefetch" href="/assets/js/17896441.b90c7a0e.js"><link rel="prefetch" href="/assets/js/9070f53a.8b0db355.js"></head>
<body class="navigation-with-keyboard" data-rh="class" style="overflow: visible;">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/replicache.svg" alt="Shiny Replicache Logo" class="themedImage_ToTc themedImage--light_HNdA"></div><b class="navbar__title text--truncate">Replicache Documentation</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/rocicorp/replicache" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Hello, Replicache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Build Your Own Backend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Backend Strategies</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true">Understand Replicache</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/how-it-works">How Replicache Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/performance">Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/offline">Offline Operation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/concepts/consistency">Consistency Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/db-isolation-level">Database Isolation Level</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/licensing">Licensing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">How To</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://replicache.notion.site/Replicache-Releases-f86ffef7f72f46ca9b597d5081e05b88" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">Releases<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Understand Replicache</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Consistency Model</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Consistency Model</h1></header><p>The <a href="https://en.wikipedia.org/wiki/Consistency_model" target="_blank" rel="noopener noreferrer">Consistency Model</a> of a distributed system like Replicache describes the guarantees the system makes about how operations are applied within the system.</p><p>Replicache was designed in consultation with indepedent distributed systems expert <a href="https://aphyr.com/about" target="_blank" rel="noopener noreferrer">Kyle Kingsbury</a> of <a href="https://jepsen.io/" target="_blank" rel="noopener noreferrer">Jepsen</a>. When properly integrated with your backend, Replicache provides <a href="https://jepsen.io/consistency/models/causal" target="_blank" rel="noopener noreferrer">Causal+ Consistency</a> — one of the strongest consistency models possible in a synchronizing system. Causal+ Consistency essentially guarantees that the system is:</p><ul><li><strong>Causal</strong>: causally-related operations (mutations) always appear in their same causal order on all clients</li><li><strong>Convergent</strong>: clients always converge on the same ordering of operations</li><li><strong>Progressive</strong>: clients see progressively newer states of the world, and never see operations out of order</li></ul><p>Below find Jepsen's summary.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="jepsen-on-replicache">Jepsen on Replicache<a href="#jepsen-on-replicache" class="hash-link" aria-label="Direct link to Jepsen on Replicache" title="Direct link to Jepsen on Replicache">​</a></h2><p><a href="https://jepsen.io/" target="_blank" rel="noopener noreferrer">Jepsen</a> has evaluated Replicache's preliminary, internal design documents, but has not evaluated Replicache's actual code or behavior. As of October 25, 2019, Replicache's documentation describes a set of client libraries and an HTTP server for writing stateful, offline-first mobile applications against typical web services. Replicache uses arbitrary JavaScript transactions over a versioned document store on the client, and expects the web service to provide corresponding server-side transaction implementations.</p><p>Like <a href="https://people.cs.umass.edu/~mcorner/courses/691M/papers/terry.pdf" target="_blank" rel="noopener noreferrer">Bayou</a> and <a href="https://groups.csail.mit.edu/tds/papers/Lynch/podc96-esds.pdf" target="_blank" rel="noopener noreferrer">Eventually Serializable Data Services</a>, Replicache works towards a totally ordered prefix of <em>final</em> transactions, while <em>tentative</em> transactions, which have not yet been totally ordered, go through a shifting series of <a href="https://jepsen.io/consistency/models/causal" target="_blank" rel="noopener noreferrer">causally consistent</a> orders after the locally-known final prefix of the total order.</p><p>Replicache's state is always the product of <em>some</em> order of atomically executed transactions, which simplifies proving some invariants. Tentative transactions execute speculatively, with causal consistency, but may be reordered, and re-executed arbitrarily many times, before their final order is known. This means their safety properties must hold under any (causally consistent) ordering of concurrent and future transactions. Tentative transactions can be thought of as an implementation of <a href="https://github.com/mochi/statebox" target="_blank" rel="noopener noreferrer">Statebox</a>, but with causally consistent transaction ordering. Likewise, any <a href="https://hal.inria.fr/inria-00609399v1/document" target="_blank" rel="noopener noreferrer">CRDT</a> can be implemented in Replicache tentative transactions alone, making them equivalent to CRDTs. However, Replicache's eventually serializable transaction order provides the ability to <em>upgrade</em> selected transactions to <a href="https://jepsen.io/consistency/models/strict-serializable" target="_blank" rel="noopener noreferrer">strict serializability</a>, at the cost of having to block for server acknowledgement. This could allow users to write hybrid commutative &amp; non-commutative systems. Replicache's API does not expose an API for serializable transactions yet, but the listener API could, we suspect, make this possible.</p><p>Casual+ is one of the strongest consistency models offline clients can ensure, and Jepsen is pleased to see additional interest in the consistency challenges of distributed mobile computing.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rocicorp/replicache/tree/main/doc/docs/concepts/consistency.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/concepts/offline"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Offline Operation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/concepts/db-isolation-level"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Database Isolation Level</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#jepsen-on-replicache" class="table-of-contents__link toc-highlight">Jepsen on Replicache</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:hello@replicache.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.replicache.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/replicache" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Rocicorp LLC.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ca11e309.js"></script>
<script src="/assets/js/main.6abc1f11.js"></script>

</body></html>